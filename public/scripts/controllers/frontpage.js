// Generated by CoffeeScript 1.10.0
(function() {
  angular.module("youtubewatcher").controller("frontpageController", [
    "$scope", "$http", "$state", function($scope, $http, $state) {
      console.log("Frontpage controller loaded");
      $scope.videos;
      $scope.outOfData = false;
      $scope.results;
      $scope.$watch("results", function() {
        if ($scope.results && $scope.results.length < 50) {
          return $scope.loadMore();
        }
      });
      $scope.loadMore = function() {
        if ($scope.outOfData) {
          return;
        }
        console.log("Loading More");
        $scope.outOfData = true;
        if ($scope.videos) {
          return $http.get("/data/mainstream/" + $scope.videos.length).success(function(data) {
            console.log(data);
            $scope.videos = $scope.videos.concat(data);
            $scope.outOfData = false;
            return console.log($scope.videos.length);
          }).error(function() {
            return $scope.outOfData = true;
          });
        } else {
          return $http.get("/data/mainstream/0").success(function(data) {
            console.log(data);
            $scope.videos = data;
            return $scope.outOfData = false;
          });
        }
      };
      $scope.playerHidden = true;
      return $scope.$on("$stateChangeSuccess", function() {
        return $scope.playerHidden = !$state.is("frontpage.video");
      });
    }
  ]);

}).call(this);
